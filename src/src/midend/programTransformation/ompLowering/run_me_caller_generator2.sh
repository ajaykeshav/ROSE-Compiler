#!/bin/bash
# A code generator to generate calls to run_me_??
# which glues the XOMP runtime library and Fortran 77 outlined functions
# This script helps implementation of OpenMP tasks

# Liao 1/24/2011

# max number of subroutine parameters
# this number should be the same value as MAX_OUTLINED_FUNC_PARAMETER_COUNT
# from libxomp.h

MAX_PARAMETER_COUNT=256
echo "/* This file is automatically generated from $0 "
echo " * Maximum number of subroutine parameters is $MAX_PARAMETER_COUNT "
echo " * To regenerate run_me_callers2.inc, type $0 > run_me_callers2.inc */"

for ((c=1; c<=$MAX_PARAMETER_COUNT; c++))
do
  echo "      case $c:"
# Fortran OpenMP lowering uses array of pointers, no special copy function is needed. We pass 0 here directly  
#  echo "            XOMP_task(run_me_$c, (void*) g_parameter, 0, *arg_size, *arg_align, *if_clause, *untied);"
  echo "            XOMP_task(run_me_task_$c, (void*) pg_parameter, cpyfn, larg_size, larg_align, bif_clause, uuntied);"
  echo "            break; "
done  
